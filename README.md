# Health Response Application

## 1. Overview

The Health Response Application is a Java Swing-based desktop application designed for conducting health risk assessments (HRAs). It allows users to register, log in, take assessments, and view their results and history. Administrators have additional capabilities to manage users, HRA questions, sponsors, and view global reports on user data and assessment outcomes.

The application connects to a MySQL database to store and retrieve all necessary data.

## 2. Features

### 2.1. User Features
*   **Registration & Login:** Users can create new accounts and log in.
*   **Take Assessment:**
    *   Answer a series of HRA questions.
    *   Supports various question types: Single Choice, Multiple Choice, Text Input.
*   **View Assessment Results:** Immediately see the total score and determined risk level after submitting an assessment.
*   **View History:** Access a history of all past assessments taken, including dates, scores, and risk levels.
*   **User Dashboard:** A central place for users to access main functionalities.

### 2.2. Administrator Features
*   **Admin Dashboard:** Central hub with quick statistics (e.g., total users) and access to management modules.
*   **User Management (CRUD):**
    *   View a list of all users.
    *   Add new users (with username, password, name, role, optional sponsor).
    *   Edit existing user details (name, role, sponsor, reset password).
    *   Delete users.
    *   Search/filter users.
*   **Question Management (CRUD):**
    *   View a list of all HRA questions.
    *   Add new questions (specifying type, title, text, options, and scores).
    *   Edit existing questions.
    *   Delete questions.
    *   View detailed information for each question.
    *   Search/filter questions.
*   **Sponsor Management (CRUD):**
    *   View a list of all sponsors.
    *   Add new sponsors.
    *   Edit sponsor names.
    *   Delete sponsors (with checks for existing users sponsored).
    *   View users associated with a specific sponsor.
    *   Search/filter sponsors.
*   **Global Reports:**
    *   **Risk Level Distribution:** Pie chart showing the distribution of users across different risk levels.
    *   **Users by Sponsor:** Bar chart showing the number of users per sponsor.
    *   **General User Statistics:** Display total number of users.

## 3. Technologies Used

*   **Language:** Java (JDK 8 or higher recommended)
*   **UI:** Java Swing
*   **Database:** MySQL (Managed via SQLYog or similar tools)
*   **Charting:** JFreeChart (for Global Reports)
*   **Password Hashing:** jBCrypt
*   **IDE:** Developed in Eclipse (as a non-Maven project)

## 4. Prerequisites

*   **Java Development Kit (JDK):** Version 8 or newer.
*   **MySQL Server:** Installed and running.
*   **MySQL Client/Tool:** SQLYog, MySQL Workbench, DBeaver, or similar for database setup.
*   **Eclipse IDE for Java Developers:** (Or any other Java IDE, but setup instructions are Eclipse-centric).
*   **MySQL Connector/J JAR:** The JDBC driver for MySQL.
*   **JFreeChart JARs:** `jfreechart-x.y.z.jar` and its dependency (e.g., `jcommon-x.y.z.jar` or `fxgraphics2d-x.y.z.jar`).

## 5. Setup and Installation

### 5.1. Database Setup
1.  **Create Database:** Using your MySQL client, create a database named `hihi`.
    ```sql
    CREATE DATABASE hihi;
    USE hihi;
    ```
2.  **Create Tables:** You will need to create the following tables. **A SQL script with the table definitions is required.** (This script was not provided, so you'll need to ensure it exists or create it based on the DAO classes).
    *   `account` (for user login credentials and roles)
    *   `users_data` (for user profile information)
    *   `sponsor_data` (for sponsor information)
    *   `hra_qna_scores` (for HRA questions, their options, and scores - note: each option is a row)
    *   `hra_responses` (for individual user answers to questions)
    *   `user_assessment_attempts` (for summarized results of each assessment attempt)
3.  **Configure Connection:**
    *   Open `com/kimquyen/healthapp/config/DatabaseConfig.java`.
    *   Update `DB_URL`, `DB_USER`, and `DB_PASSWORD` to match your MySQL setup.
4.  **Initial Admin Account (Manual or Utility):**
    *   You'll need at least one admin account to manage the system.
    *   Run the `com.kimquyen.healthapp.util.PasswordHasherUtil.java` utility. It will print hashed passwords to the console.
    *   Manually insert an admin record into the `users_data` table and then into the `account` table using a hashed password generated by the utility.
        *   Example `users_data` insert: `INSERT INTO users_data (name, created_at) VALUES ('Super Admin', NOW());` (Get the `id` of this new row).
        *   Example `account` insert: `INSERT INTO account (username, password, role, user_data_fk_id) VALUES ('superadmin', 'YOUR_HASHED_PASSWORD_HERE', 'ADMIN', ID_FROM_USERS_DATA);`
5.  **Generate Accounts for Existing Users (Optional):**
    *   If you have data in `users_data` without corresponding entries in the `account` table, run `com.kimquyen.healthapp.util.AccountGeneratorUtil.java`. This utility will attempt to create default accounts for them.

### 5.2. Eclipse Project Setup
1.  **Import Project:**
    *   In Eclipse, go to `File` -> `Import...`.
    *   Choose `General` -> `Existing Projects into Workspace`.
    *   Select the root directory of your project and click `Finish`.
2.  **Add Libraries (JARs) to Build Path:** Since this is not a Maven project, you must manually add external JARs.
    *   Create a `lib` folder in your project root if it doesn't exist.
    *   Copy the following JAR files into the `lib` folder:
        *   MySQL Connector/J JAR (e.g., `mysql-connector-java-8.0.x.jar`)
        *   JFreeChart JAR (e.g., `jfreechart-1.0.19.jar` or `jfreechart-1.5.3.jar`)
        *   JFreeChart dependency JAR (e.g., `jcommon-1.0.23.jar` for older JFreeChart, or `fxgraphics2d-1.8.jar` for JFreeChart 1.5.x)
        *   jBCrypt JAR (e.g., `jbcrypt-0.4.jar`)
    *   Right-click on your project in Eclipse's "Package Explorer".
    *   Select `Build Path` -> `Configure Build Path...`.
    *   Go to the `Libraries` tab.
    *   Click `Add JARs...`.
    *   Navigate to the `lib` folder in your project and select all the JARs you copied.
    *   Click `OK`, then `Apply and Close`.
3.  **Clean and Rebuild:**
    *   Go to `Project` -> `Clean...`, select your project, and click `Clean`.

## 6. Running the Application

1.  Locate the `com.kimquyen.healthapp.MainApp.java` file in the Package Explorer.
2.  Right-click on `MainApp.java` and select `Run As` -> `Java Application`.
3.  The Login window should appear.

## 7. Known Issues / Notes

*   **Non-Maven Project:** Dependency management is manual. Ensure all required JARs are correctly added to the build path.
*   **Database Schema:** The `hra_qna_scores` table has a denormalized structure where question details (title, text, type) are repeated for each option. This makes CRUD operations in `HraQuestionDAO` complex.
*   **Concurrency:** The `HraQuestionDAO.getNextQuestionId()` method is not concurrency-safe. This is generally not an issue for a single-user admin scenario but would be problematic in a multi-user concurrent environment.
*   **Transaction Management:** Service methods performing multiple database operations (e.g., user registration, user deletion) do not have explicit database transaction management. This could lead to data inconsistencies if one part of an operation fails.
*   **Error Handling:** DAOs primarily print stack traces and return null/false. For a more robust application, custom exceptions might be considered.

## 8. Future Enhancements (Suggestions)

*   Refactor `HraQuestionDAO` and potentially the `hra_qna_scores` table schema for easier management.
*   Enhance UI/UX with more modern look and feel or components.
*   Add more detailed reporting features.
*   Implement internationalization (i18n) for multiple language support.






